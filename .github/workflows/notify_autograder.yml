name: Notify Autograder

on:
  push:
    branches:
      - main

jobs:
  dispatch:
    runs-on: ubuntu-latest
    steps:
      - name: Notify private autograder
        run: |
          gh api \
            --method POST \
            -H "Accept: application/vnd.github+json" \
            /repos/IS640PythonOrg/is640-autograder-etl/dispatches \
            -f event_type='run-autograding' \
            -f client_payload[repository]="${{ github.repository }}"
        env:
          GITHUB_TOKEN: ${{ secrets.AUTOGRADER_PAT }}